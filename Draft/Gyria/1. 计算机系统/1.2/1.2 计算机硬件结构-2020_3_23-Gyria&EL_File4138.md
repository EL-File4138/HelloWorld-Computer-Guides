# 第二节 计算机硬件结构

*Author: Gyria*

*Editor：EL_File4138 Rikakoist*

前言：上一讲说到，尽管计算机技术自20世纪40年代第一部电子通用计算机诞生以来有了令人目眩的快速发展，但是今天的计算机仍基本上采用存储程序结构，即**冯·诺伊曼结构**。这个结构实现了实用化的通用计算机。**计算机系统由硬件和软件两部分组成**。硬件系统是计算机的“躯干”，是物质基础。而软件系统则是建立在这个“躯干”上的“灵魂”。

*****

## 计算机的分类

在说存储器之前，先介绍一点常识性知识——计算机的分类。
根据计算机的性能指标，如规模大小、运算速度高低、存储容量大小、机器价格等因素可将计算机分为**巨型机、大型机、中型机、小型机、微型机和工作站**。

- 巨型机：**具有超强计算与处理数据能力，主要特点为高速度与大容量**。主要用来承担重大的科学研究、国防尖端技术和国民经济领域的大型计算课题及数据处理任务。如：大范围天气预报、整理卫星照片、原子核物探索等。代表机型：“天河一号”我国首台千万亿级超级计算机、神威·太湖之光，目前（2020年4月）中国算力最强的计算机；
- 大、中型机：**使用专用指令集与操作系统和软件，大量使用冗（rǒng）余等技术（也称容灾备份技术）确保其安全性与稳定性，擅长数据处理，主要用于商业领域**，如：银行部门和电信部门的重要数据存储；
- 小型机：**采用精简指令集处理器**，性能与价格介于服务器和大型主机之间的一种高性能64位处理器；
- 微型机：也就是非常普遍的**个人计算机**，不作过多描述；
- 工作站：一种**高端的通用微型机**，提供比普通的个人计算机更强大的性能，尤其是在图形处理能力与任务并行方面的能力。

*****

## 计算机的硬件结构

通常来说，我们指的计算机为冯·诺依曼型机，其有几个基本的部件：**运算器、控制器、存储器、输入设备、输出设备**。反映在现代计算机中，就是如下的实现：

### 中央处理器（CPU - Central Processing Unit）

CPU简称处理器，是计算机系统的运算和控制核心，是决定计算机性能的关键部件（相当于汽车的发动机）。

**它由运算器、控制器和一些寄存器组成**。从原理上看，CPU的内部结构分**控制单元、逻辑单元、存储单元**三部分。

处理器的核心是大小为一个字的寄存器，称为**程序计数器（PC）**。

在任何时候，PC都指向主存中的某条机器语言指令（即含有该条指令的地址）。

附图：2.1 CPU

##### 运算器

**运算器是指计算机中进行各种算术和逻辑运算操作的部件**。其中 **算术逻辑单元（ALU）** 是CPU核心的部分，它进行各种算术运算和逻辑运算。

算术逻辑单元（ALU）可以被称作计算机的大脑。它能做两类运算：

- 算术运算，比如对两个数字进行加减法；
- 比较运算，即给定两个数，ALU对其进行比较以确定哪个更大一些。

##### 控制器

**控制器是计算机的指挥系统**，控制器负责指挥CPU工作，通过该设备的运行来控制其他设备的活动。

控制器由程序状态寄存器（PSR），系统状态寄存器（SSR），程序计数器（PC），指令均存器等组成，其作为“中央首脑”和“决策机构”的主要任务就是发布命令，发挥着整个计算机系统操作的协调与指挥作用。

##### 寄存器

**寄存器的功能是存储二进制代码**，它是由具有存储功能的触发器组合起来构成的。一个触发器可以存储1位二进制代码，故存放n位二进制代码的寄存器，需用n个触发器来构成。

#### 衡量CPU性能的主要指标

CPU的主要性能指标是**主频**和**字长**（其他指标有指令集合、高速缓存容量，制造工艺，封装方式、工作电压等）。

字长决定**运算精度**，主频决定**运算速度**（但不是绝对的）。

字长：指的是CPU能够同时处理的二进制位数的个数。

主频：指的是CPU工作的时钟频率，一般来说主频越高，一个时钟周期里面完成的指令数就越多，速度也就越快。主频的单位是MHz和GHz（1GHz=1000MHz）。

#### CPU的工作原理

我们知道，冯·诺依曼体系结构是现代计算机的基础。在该体系结构下，**程序和数据统一存储，指令和数据需要从同一存储空间存取，经由同一总线传输，无法重叠执行**。

根据冯·诺依曼体系，CPU的工作分为以下5个阶段：**取指令阶段、指令译码阶段、执行指令阶段、访存取数和结果写回**。

附图：2.2 CPU的工作原理

1. 取指令（IF，Instruction Fetch）。即将一条指令从主存储器中取到指令寄存器的过程。程序计数器中的数值，用来指示当前指令在主存中的位置。当一条指令被取出后，PC中的数值将根据指令字长度自动递增；
2. 指令译码阶段（ID，Instruction Decode）。取出指令后，指令译码器按照预定的指令格式，对取回的指令进行拆分和解释，识别区分出不同的指令类别以及各种获取操作数的方法；
3. 执行指令阶段（EX，Execute）。具体实现指令的功能。CPU的不同部分被连接起来，以执行所需的操作；
4. 访存取数阶段（MEM，Memory）。根据指令需要访问主存、读取操作数，CPU得到操作数在主存中的地址，并从主存中读取该操作数用于运算。部分指令不需要访问主存，则可以跳过该阶段；
5. 结果写回阶段（WB，Write Back）。作为最后一个阶段，结果写回阶段把执行指令阶段的运行结果数据“写回”到某种存储形式。结果数据一般会被写到CPU的内部寄存器中，以便被后续的指令快速地存取；许多指令还会改变程序状态字寄存器中标志位的状态，这些标志位标识着不同的操作结果，可被用来影响程序的动作。

在指令执行完毕、结果数据写回之后，若无意外事件（如结果溢出等）发生，计算机就从程序计数器中取得下一条指令地址，开始新一轮的循环，下一个指令周期将顺序取出下一条指令。

（原理部分内容些许超纲，根据自身能力理解，不作过多要求）

#### CPU的发展历史

20世纪80年代以来ALU和控制单元（二者合称中央处理器）逐渐被集成到一块集成电路上，称作微处理器。

CPU出现于大规模集成电路时代，处理器架构设计的迭代更新以及集成电路工艺的不断提升促使其不断发展完善。从最初专用于数学计算到广泛应用于通用计算，从4位到8位、16位、32位处理器，最后到64位处理器，从各厂商互不兼容到不同指令集架构规范的出现，CPU自诞生以来一直在飞速发展。

CPU已经有40多年的历史了。我们通常将其分成六个阶段：

1. 第一阶段（1971年-1973年）。这是4位和8位低端微处理器时代，代表产品是Intel 4004处理器；
2. 第二阶段（1974年-1977年）。这是8位中高端微处理器时代，代表产品是Intel 8080。此时指令系统已经比较完善了；
3. 第三阶段（1978年-1984年）。这是16位微处理器的时代，代表产品是Intel 8086。相对而言已经比较成熟了；
4. 第四阶段（1985年-1992年）。这是32位微处理器时代，代表产品是Intel 80386。已经可以胜任多任务、多用户的作业；
5. 第五阶段（1993年-2005年）。这是奔腾系列微处理器的时代；
6. 第六阶段（2005年至今）。是酷睿系列微处理器的时代，这是一款领先节能的新型微架构，设计的出发点是提供卓然出众的性能和能效。 

为了满足操作系统的上层工作需求，现代处理器进一步引入了诸如并行化、多核化、虚拟化以及远程管理系统等功能，不断推动着上层信息系统向前发展。

### I/O

I/O（英语：Input/Output），即输入/输出，通常指数据在存储器（内部和外部）或其他周边设备之间的输入和输出，是信息处理系统（例如计算机）与外部世界（可能是人类或另一信息处理系统）之间的通信。输入是系统接收的信号或数据，输出则是从其发送的信号或数据。

在现代计算机体系结构中CPU可以使用单独的指令直接读取或写入，被认为是计算机的核心。而CPU和主存储器的组合，任何信息传入或传出CPU/内存组合，例如通过从磁盘驱动器读取数据，就会被认为是I/O.

#### 输入设备

输入设备是外界向计算机传送信息的装置。在微型计算机系统中，最常见的输入设备是键盘和鼠标。

其他常见的输入设备有：麦克风、数位板、图像扫描仪、光电笔、触摸屏等。

#### 输出设备

输出设备的作用是将计算机中的数据信息传送到外部媒介，并转化成某种为人们所认识的表示形式。

在微型计算机中，最常见的输出设备有显示器和打印机、绘图仪等。

### 主板

主板（英语：Motherboard，Mainboard，简称Mobo）；是构成复杂电子系统例如电子计算机的中心或者主电路板。

下图的LGA 1366主板包含南桥和北桥，这是最后一代使用双芯片的主板。之后所有Intel与AMD的主板仅有南桥，北桥已集成到CPU。

附图：4.1主板

*1.CPU插座 （LGA 1366）  2.北桥（被散热片覆盖） 3.南桥（被散热片覆盖） 4.存储器插座（三通道） 5.PCI扩展槽 6.PCI Express扩展槽 7.跳线 8.控制面板（开关掣、LED等） 9.20+4pin主板电源 10.4+4pin处理器电源 11.背板I/O 12.前置USB针脚 13.前置面板音效针脚 14.SATA插座 15.ATA插座（大部分Intel Sandy Bridge微架构以后的家用主板都已舍弃IDE接口） 16.软盘驱动器插座（2010年代起，绝大多数主板已舍弃软盘驱动器接口）*

典型的主板能提供一系列接合点，供处理器、显卡、硬盘驱动器、存储器、对外设备等设备接合。它们通常直接插入有关插槽，或用线路连接。主板上最重要的构成组件是芯片组。早期的芯片组通常由北桥和南桥组成，现在的Intel/AMD芯片组绝大多数采用单片机设计，增强其性能。

芯片组为主板提供一个通用平台供不同设备连接，控制不同设备的沟通。它亦包含对不同扩展插槽的支持，例如处理器、PCI Express。芯片组亦为主板提供额外功能，例如内置于芯片组的GPU。现在的家用主板绝大多数内置声卡、网卡。一些主板也集成红外通信技术、蓝牙和802.11（Wi-Fi）等功能。部分电竞主板支持RGB LED光效功能。

#### 主板尺寸

不同主板规格有不同功用，所以大小也有不同。现时常用ATX、MicroATX、ITX、Mini ATX。

- Mini ATX（11.2" × 8.2"或284 mm × 208 mm）；
- Micro ATX（1996; 9.6" × 9.6"或244 mm × 244 mm）- 扩展插口比ATX规格少；
- Mini-ITX （170mm x 170mm）；
- ATX（12" × 9.6"或305 mm × 244 mm）；

### 南桥与北桥

南桥是基于个人电脑主板芯片组架构中的其中一枚芯片。南桥设计用来处理低速信号，通过北桥与中央处理器联系。

北桥用来处理高速信号，例如中央处理器、存储器、显卡（PCI Express接口或AGP接口），还有与南桥之间的通信。

### BIOS

BIOS是Basic Input/Output System的缩写，中文：基本输入输出系统，亦称为ROM BIOS、System BIOS、PC BIOS，是在通电引导阶段运行硬件初始化，以及为操作系统提供运行时服务的固件。BIOS预安装在个人电脑的主板上，是个人电脑启动时加载的第一个软件。

现在，BIOS的作用是初始化和测试硬件组件，以及从大容量存储设备（如硬盘）加载引导程序，并由引导程序加载操作系统。BIOS还为DOS操作系统提供键盘、显示及其他I/O设备的硬件抽象层。

许多BIOS程序都只能在特定电脑型号或特定主板型号上运行。早年，BIOS存储于ROM芯片上；现在的BIOS多存储于闪存芯片上，这方便了BIOS的更新。

### 总线

总线（Bus）是指计算机组件间规范化的交换数据（Data）的方式，即以一种通用的方式为各组件提供数据传送和控制逻辑。

从另一个角度来看，如果说主板（Motherboard）是一座城市，那么总线就像是城市里的公共汽车（Bus），能按照固定行车路线，传输来回不停运作的比特（Bit）。这些线路在同一时间内都仅能负责传输一个比特。因此，必须同时采用多条线路才能发送更多数据，而总线可同时传输的数据数就称为宽度（Width），以比特为单位，总线宽度愈大，传输性能就愈佳。

总线的带宽（即单位时间内可以传输的总数据数）为：总线带宽 = 频率×宽度（Bytes/sec）。

#### 总线种类

- 数据总线（Data Bus）：在CPU与RAM之间来回传送需要处理或是需要储存的数据，它主要连接了CPU与各个部件；
- 地址总线（Address Bus）：用来指定在RAM（Random Access Memory）之中储存的数据的地址；
- 控制总线（Control Bus）：将微处理器控制单元（Control Unit）的信号，传送到周边设备，一般常见的为USB Bus和1394 Bus；
- 扩展总线（Expansion Bus）：可连接扩展槽和电脑；
- 局部总线（Local Bus）：取代更高速数据传输的扩展总线。

下面是一个典型的计算机硬件系统。

附图：2.4 典型的计算机硬件系统


### 存储器

**存储器的主要功能是用来保存各类程序的数据信息。**

概念上讲，一部计算机的存储器可以被视为一组“细胞”单元。**每一个“细胞”都有一个编号，称为地址；又都可以存储一个较小的定长信息**。

这个信息既可以是**指令（告诉计算机去做什么）**，也可以是**数据（指令的处理对象）**。原则上，每一个“细胞”都是可以存储二者之任一的。

而现代存储器是一种利用半导体、磁性介质等技术制成的存储数据的电子设备。其电子电路中的数据以二进制方式存储，不同存储器产品中基本单元的名称也不一样。

计算机存储器可分为**内部存储器（简称内存或主存）和外部存储器**，其中内存是CPU能直接寻址的存储空间，由半导体器件制成。

内存的特点是**访问速率快**。我们平常使用的程序，如Windows操作系统、打字软件、游戏软件等，一般都是安装在硬盘等外存上的，但必须把它们调入内存中运行，才能真正使用其功能，我们平时输入一段文字，或玩一个游戏，其实都是在内存中进行的，数据产生后不断地由内存向外存进行刷写。就好比在一个书房里，存放书籍的书架和书柜相当于电脑的外存，而我们工作的办公桌就是内存。

通常我们把要永久保存的、大量的数据存储在外存上，而把一些临时的或少量的数据和程序放在内存上。内存的好坏会直接影响电脑的运行速度。

#### 主存储器（也称内存储器）

主存储器（也称内存储器），属于主机的一部分。用于**存放当前系统正在执行的数据和文件**，属于**临时存储器**。

它和CPU一起构成了计算机主机部分，它存储的信息可被CPU直接访问。内存由半导体存储器组成，存取速度快但容量较小。

内存中含有许多存储单元，每个单元可以存放一个8位的二进制数，即一个字节（Byte,简称“B”）内存中每个字节各有一个固定的编号，这个编号称为地址。

内存储器通常可以分为**随机存储器RAM、只读存储器ROM、高速缓冲存储器Cache三种**。

- RAM：RAM存储的内容**可以随时根据需要读出、也可以随时重新写入新的信息**。**当去掉电源电压时，RAM中保存的信息将全部丢失**。（就像你在Word文档打字突然停电了而文件未保存，你输入的文字全部丢失了）
- **ROM是一种内容只能读出而不能写入和修改的存储器，其存储的信息是在制作该存储器时就被写入的**。在计算机运行过程中，ROM中的信息只能被读出，而不能写入新的内容。计算机断电后，ROM的信息不会丢失。它主要用于检查计算机系统的配置情况并提供最基本的输入/输出（I/O）控制程序。
- Cache:由于CPU速度不断的提高，RAM的速度很难满足高速CPU的要求，所以在读/写系统内存时要加入等待的时间，这对高速CPU来说是一种极大的浪费。**Cache是指在CPU与内存之间设置的一级或两级高速小容量存储器，称为高速缓冲存储器**，固化在主板上或CPU内。

在计算机工作时，系统先将数据由外存读入RAM中，再由RAM读入Cache中，然后CPU直接从Cache中取数据进行操作。

##### 外部存储器

**外存储器**又称辅助存储器，它的容量一般都**比较大**，而且大部分可以移动，便于在不同计算机之间进行信息交流。

在微型计算机中，常用的外存有：**软盘、硬盘、闪存和光盘**4种。

###### 软盘存储器

软盘存储器由软盘、软盘驱动器和软盘适配器三部分组成。软盘是活动的存储介质，软盘驱动器是读写装置，软盘适配器是软盘驱动器与主机连接的接口（如USB接口）。软盘驱动器安装在主机箱内，软盘驱动器插槽暴露在主机箱的前面板上，可方便地插入或取出软盘。

###### 硬盘存储器
硬盘存储器是由电机和硬盘组成的，一般置于主机箱内。硬盘是涂油磁性材料的磁盘组件，用于存放数据。硬盘的机械转轴上串有若干个盘片，每个盘片的上下两面各有一个读/写磁头，与软盘磁头不同，硬盘的磁头不与磁盘表面接触，它们“飞”在离盘片面百万分之一英寸的“气垫”上。

硬盘是一个非常精密的机械装置，磁道间只有百万分之几的间隙，磁头传动装置必须把磁头快速而精准地移到指定的磁道上。

附图：2.5

```
磁道（Track）
柱面（Cylinder）
扇区（Sector）
磁头（Heads）
盘片（Platters）
每个碟片都有两面，因此也会相对应每碟片有2个磁头。
```

2.6

```
A：磁道
B：扇面
C：扇区
D：簇（扇区组）
在硬盘上定位某一数据记录位置—C扇区，使用了三维定位。
```           

##### 闪存

闪存又名U盘，是在存储速度与容量上介于软盘和硬盘之间的一种外部存储器。

#### 存储器的容量

所谓的存储器容量，即指存储器所包含的字节数，通常用**KB、MB、GB、TB和PB**作为存储器的容量单位。他们之间的关系为：
```
1 Kilobyte（KB） =1,024B=2^10B
1 Megabyte（MB）=1,024KiB=2^20B=1,048,576B
1 Gigabyte（GB）=1,024MiB=2^30B=1,073,741,824B
1 Terabyte（TB）=1,024GiB=2^40B
1 Petabyte（PB）=1,024TiB=2^50B
1 Exabyte（EB） =1,024PiB=2^60B
1 Zettabyte（ZB）=1,024EiB=2^70B
1 Yottabyte（YB）=1,024ZiB=2^80B
```
根据电气电子工程师协会（IEEE 1541）和欧洲联盟（HD 60027-2:2003-03）的标准，二进制乘数词头的缩写为“Ki”、“Mi”、“Gi”，以避免与SI Unit国际单位制混淆。但二进制乘数词头没有广泛被制造业和个人采用。

##### 硬盘的数据接口

机械硬盘按数据接口不同，大致分为**ATA（又称IDE）和SATA以及SCSI和SAS**。接口速度不是实际硬盘数据传输的速度，当前普通机械硬盘的实际数据传输速度一般不会超过300MB/s。

- ATA:（Advanced Technology Attachment），是用传统的40-pin并口数据线连接主板与硬盘的，接口速度最大为133MB/s，因为并口线的抗干扰性太差，且排线占用空间较大，不利电脑内部散热，已逐渐被SATA所取代；
- SATA:（Serial ATA），也就是使用串口的ATA接口，特点是抗干扰性强，对数据线的要求比ATA低很多，且支持热插拔等功能。SATA-II的接口速度为300MiB/s，而新的SATA-III标准可达到600MiB/s的传输速度。SATA的数据线也比ATA的细得多，有利于机箱内的空气流通，整理线材也比较方便；
- SCSI:（Small Computer System Interface（小型机系统接口），SCSI硬盘广为工作站级个人电脑以及服务器所使用，因此会使用较为先进的技术，如碟片转速15000rpm的高转速，且资料传输时CPU占用率较低，但是单价也比相同容量的ATA及SATA硬盘更加昂贵；
- SAS:（Serial Attached SCSI），是新一代的SCSI技术，可兼容SATA硬盘，都是采取序列式技术以获得更高的传输速度，可达到12Gb/s。此外也透过缩小连接线改善系统内部空间等；
- FC:（Fibre Channel（光纤通道接口），拥有此接口的硬盘在使用光纤联接时具有热插拔性、高速带宽（4Gb/s或10Gb/s）、远程连接等特点；内部传输速率也比普通硬盘更高。但其价格高昂，因此FC接口通常只用于高端服务器领域。

固态硬盘当前主要有**SATA，M.2和PCI-E**3种。
- M.2: （Next Generation Form Factor），是计算机内部扩展卡及相关连接器规范。其采用了全新的物理布局和连接器，将取代Mini PCI Express及mSATA标准。这是中高速SSD目前最常用的接口选项。在逻辑上，M.2等价于PCI-E，只不过接口更迷你，也仅支持PCI-E x4以下。
- PCI-E: 目前最高端的PC硬盘接口，由于使用原生PCI-E接口因此可以支持x8甚至x16级别的传输协议，但在存储设备方面并不像M.2一样拥有统一的规范，目前主要是Intel的固态部门在产。

## 计算机的主要性能指标

1. 字长：字长是指一台计算机所能处理的二进制代码的位数。计算机字长直接影响它的精度、功能和速度。字长越长，能表示的数值范围就越大，计算出的结果的有效位数也就越多；字长越长，单次计算能包含的信息就越多，机器的功能就更强。目前常用的是32位、64位字长；
2. 运算速度：运算速度是指计算机每秒所能执行的指令条数，一般用MIPS（Million of Instructioms Per Second,即每秒百万条指令为单位）；
3. 主频：CPU时钟频率很大程度上绝定了计算机的运算速度。主频越高，运算速度越快；
4. 内存容量：注意是内存容量，不是外存，内存容量反映内存储器存储数据的能力。目前主流的是4GB、8GB、16GB为普遍的计算机容量。

在学完以上的全部内容后，对于计算机的一个硬件系统你应该有基本的了解了，但前面说过，计算机系统是由硬件和软件两部分组成的，在下一讲，我们将开始学习软件——操作系统。


